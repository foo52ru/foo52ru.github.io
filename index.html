<!doctype html>
<html>
    <head>
    <title>sexual_reproduction</title>  <meta charset='utf-8' />
      <style>
           body {font-size: 16pt; }
		   h1 { font-size: 240%; color: rgb(70,70,130); text-align: center;} 
		   h2 { font-size: 170%; color: rgb(50,50,120); text-align: center; } 
		   h3 { font-size: 130%; color: rgb(10,10,100); padding-left: 10px;} 
		   h4 { font-size: 110%; color: rgb(10,10,80); padding-left: 10px;} 		   
		   p {  padding-left: 10px;}
		   div { padding-left: 60px;}
		   img { padding-left: 100px;}
		   blockquote{  background-color: rgb(230,230,230);}
		   code {  background-color: rgb(230,230,230);}
  		</style>
    </head>
<body>

<h1>Преимущество полового размножение перед бесполым</h1>

<p>Попоробуем на небольших моделях сравнить половое и бесполое размножение.</p>

<p> Определимся с понятиями, которые будут использоваться в моделях</p>
<ul>
<li><b>идеальный геном </b>   - предварительно заданный вариант генома, который обеспечивает максимальную приспособленность к окружающей среде </li>
<li><b>геном</b> - последовательность чисел или символов, которые, посредством естественного отбора, должны прийти к идеальному варианту </li>
<li><b>половое размножение</b> - размножение с рекомбинацией генетического материала между разными особями. </li>
<li><b>бесполое размножением</b> - создание организмом своей копии <i>(деление, почкование, клонирование)</i> </li>
<li><b>мутация</b> - у вновь созданного организма с некоторой вероятностью меняем случайное значение в геноме на случайное другое </li>

</ul>

<p>
В реальности всё несколько сложнее. 
</p>
<p>
Есть варианты полового размножения, где не происходит смешивание геномов <i>(партеногенез)</i>,</br>
а организмы с бесполым размножением могут использовать альтернативные способы перемешивания геномов <i>(горизонталный перенос генов)</i>
</p>
<p>
Структуру реального генома достаточна сложна, но для простых математических моделей будет достаточно представлять его в виде простой последовательности</i>
</p>
<p>
Начнём с первой простой модели.
</p>

<hr>
<h2>простая модель</h2>
<hr>
<h3>model No. 1</h3>
<div>
<canvas id="cnv_s1" width="900" height="480" style="border: 1px solid #000000;"></canvas><br>
<button id="step_s1">START</button> 
<input id="loop_s1" checked  type="checkbox"> loop &nbsp; &nbsp; &nbsp;
<input id="cross_s1" type="checkbox"> cross &nbsp; &nbsp; &nbsp;
<input id="graph_s1" type="checkbox"> graph &nbsp; &nbsp; &nbsp;   
<button id="reset_s1">RESET</button> 
<p> вероятность мутации &nbsp;
  <select id="mut_select_s1">
	<option> 0.1 </option> <option selected> 0.2 </option> <option> 0.3 </option>
	<option> 0.4 </option> <option > 0.5 </option> <option> 0.6 </option> 
	<option> 0.7 </option> <option >0.8</option> <option> 0.9</option><option> 1.0 </option>
  </select></p>

</div>
<hr>
<script src="script/char20.js" > </script>



<h3>описание модели</h3>
<img src="img/model1.png" />

<h4>направление обора</h4>
<p>
В самом верху синим цветом представлен <b>идеальный геном</b>, к которому все организмы должны прийти.
<br>
<b>Геном</b> представляет из себя строку, длиной в 57 символов.<br>
Всего 20 особей, их геном записан по строчкам.<br>
Изначально геном организмов заполнен пробелами.<br>
Для выполнения задачи даётся 900 поколений.
</p>

<h4>приспособленность</h4>
<p>
Приспособленность организма определяется тем, сколько символов в его геноме совпадает с символами в идеальном геноме.<br>
В модели подобные совпадающие гены помеченны зелёным цветом. <br>
Приспособленность организма показана с левой стороны.
</p>

<h4>отбор</h4>

<p>В каждом поколении будем оставлять половину особей, на основе которых будет формироваться следующее поколение.</p>

<p>Можно было оставлять особи с наибольшей приспособленностью, но в модели используется более естественный способ.</p>
<p>
Приспособленность особи определяет вероятность того, что она оставит потомство.<br>
То есть даже самая приспособленная особь может погибнуть, не оставив потомства, <br>
а наименее приспособленная может умудриться его оставить.<br>
Такой вариант больше похоже на то, что происходит в реальности.</p>

<p>Рассмотрим, как это реализованно в модели </p>

<p>
Например, у нас есть три особи с приспособленностью равной 11, 13, 12.<br>
Нужно выбрать, кто оставит потомство.</p>

<img src="img/otbor.png" /> <br>

<p>
<ol>
 <li>Вычитаем из их приспособленности число на единицу меньше, чем минимальная приспособленность. <br>
 <code> приспособленность  = приспособленость - (минимальная приспособленность - 1)</code><br>
 В итоге теперь приспособленность равна: 1, 3, 2
 </li>
 <li>Складываем все приспособленности</li>
 <li>Генерируем случайное число от 0 до полученной суммы. <br>
 Это число и укажет, которая особь оставит потомство</li>
</ol>

Благодарь такому алгоритму вероятности распределяться следующим образом:
<ul>
<li> 1 особь (11) - 16.7 % </li>
<li> 2 особь (13) - 50.0 % </li>
<li> 3 особь (12) - 33.3 % </li>
</ul>
</p>


<h4>размножение</h4>
<p>
Каждый ход отбирается половина особей из которых будет формироваться следующее поколение.<br>
Отобранные особи помечены символом решётки (#) с левой стороны.<br>
Способ размножения определяется нами. Если поставить галочку в чекбоксе <b>cross</b>, то будет использоваться <b>половое размножение</b>. <br>
<ul>
<li> <b>бесполое размножение</b> - каждая особь, выбранная для размножение, создаёт пару своих клонов.<br>
В итоге каждая выбранная особь является предком ровно для двух особей в новом поколении.
</li>
<li><b>половое размножение</b> - особь, выбранная для размножение, выбирает себе пару из особей, выбранных для размножения и у них получается потомок, чей геном - это случайная рекомбинация геномов родителей.<br>
Происходиn это два раза для каждой особи, что бы обеспечить сохранность численности популяции.<br>
В итоге каждая выбранная особь является предком для двух или более особей в новом поколении.
</li>
</ul>
</p>
<img src="img/reprod.png" />
<h4>мутации</h4>
<p>
После формирования нового поколения у каждой особи может произойти мутация.<br>
Вероятность мутации можно задать самому.<br>
При мутации символ в случайном месте генома особи меняется на другой случайный символ.<br>
</p>


<h4>Немного теории</h4>
<p>
Допустим, нас есть два организма и каждый имеет один полезный ген в разных местах. </p>
<p>
При <b>бесполом размножении</b> в популяции сможет остаться только один вариант.<br>
Если было бы много вариантов полезных генов в разных местах у разных организмов,<br> 
то в итоге всё равно останется только один. <br>
Что бы у организмов было два полезных гена вместо одного, нужно ждать удачную мутацию.<br> 

</p>

<p>
При <b>половом размножении</b>  организм с двумя полезными генами может появиться уже в следующем поколении.<br>
</p>

<img src="img/adv.png" />
<p>
Глядя на эту схему, становиться понятным, что половое размножение намного эффективнее. <br>
Но поиграв с первой простой моделью, вы обнаружите, что особых преимуществ не наблюдается. <br>
Только при большой вероятности мутации, половое размножение начинает показывать лучшие результаты.  <br>
</p>

<p>
Дело в том, что половое размножение станет эффективнее безполого если в популяции одновремено существовуют много разных полезных генов у разных особей. <br>
В этом случае все эти полезные мутации начнут соединяться в следующем поколении.
</p>

<p>
Добиться этого можно увеличением размера популяции и увеличением длины генома. <br>
Чем больше размер популяции, тем больше разных полезных генов будет в поколении, тем более эффективным становиться половое размножение.</p>

<p>
Но размер популяции также имеет колоссальную роль для естественного отбора. <br>
В большой популяции даже небольшие преимущества, которые обеспечивает новая мутация, будут замечены естественным отбором и она быстро распространится по популяции.
</p>

<p>
Здесь стоит показать дополнительную модель, показывающую, как в популяции меняется частота вариантов одного и того же гена при смене поколений и как от размера популяции зависит эффективность естественного отбора.
</p>

  
<hr>   
   <h2>дрейф генов против естественного отбора</h2>
<hr>
<h3>model No. 2</h3>
<div>
<canvas id="cnv_s2" width="900" height="530" style="border: 1px solid #000000;"></canvas> <br>
<button id="rbtn_s2">START</button> <br>
<p>размер популяции &nbsp;
<select id="popul_select_s2">
	<option > 100</option><option >200</option> <option> 500</option>
	<option selected >1000</option> <option> 2000</option>
	<option >4000</option> <option> 8000</option><option >16000</option> <option> 32000</option>
	<option >64000</option> <option >128000</option> <option> 256000</option>
</select></p>
<p>адаптивное преимущество &nbsp;
<select id="advan_select_s2">
	<option selected > 0</option>
	<option >0.1</option> <option> 0.2</option><option >0.5</option> <option> 1.0</option>
	<option >1.5</option> <option> 2.0</option><option >2.5</option> <option> 3.0</option>
	<option >3.5</option> <option> 4.0</option><option >4.5</option> <option >5.0</option> 
</select></p>
<p>стартовые пропорции &nbsp;
<select id="prop_select_s2">
	<option> 0.1 </option> <option> 0.2 </option> <option> 0.3 </option>
	<option> 0.4 </option> <option selected> 0.5 </option> <option> 0.6 </option> 
	<option> 0.7 </option> <option >0.8</option> <option> 0.9</option>
</select></p>
</div>
<hr>
<script  src="script/drift.js" > </script>     
   
   
 <p>Некоторые понятия</p> 
<ul>  
<li><b>аллели</b> -  разные варианты одного и того же гена</li>
<li><b>дрейф генов</b> - случайные изменения частот аллелей при смене поколений. </li>   
</ul>   

<p>
В популяции могут присутствовать разные варианты одного и того же гена <b>(аллели)</b>.<br>
Если полезность каждого <b>аллеля</b> одинакова, то при переходе к следующиму поколению 
будет наблюдаться смещение частот <b>аллелей</b> случайным образом.
</p>
<p>
Причём, чем меньше размер популяции, тем более резкие изменения в частоте <b>аллелей</b> будут происходить.<br>
В популяции конечного размера одна <b>аллель</b> со временем вытеснит другую.<br>
Чем меньше размер популяции, тем быстрее это произойдёт.
</p>
<p>
Если <b>аллель</b> даёт преимущество, то чем больше размер популяции, тем с большей вероятностью он вытеснит все остальные <b>аллели</b>. <br>
В популяции маленького размера, аллель, дающий преимущество, вполне может исчезнуть благодаря случайным флуктуациям частоты аллеля из поколения в поколение.
</p>
<p style="background-color:rgb(255,255,100);" >
В популяции маленького размера <b>дрейф генов</b> может играть более важную роль, чем <b>естесвенный отбор</b>.<br>
</p>
<p>
Всё это можно увидеть на скриншотах запуска модели с разными параметрами.<br>
Графики показывает распространения в популяции аллеля, дающего преимущество в 0.5 %. 
</p>
<p>
На левом графике четыре  симуляции при чиленности популяции равной 1000. <br>
В двух случаях из четырёх аллель исчезла, даже несмотря на преимущество, которое оно обеспечивало.
</p>
<p>
На правом графике четыре симуляции при чиленности популяции равной 256000. <br>
Естественный отбор подхватил это вариант гена и частота аллеля стала возрастать
</p>

<img src="img/drf1.png" />

<h4>как это реализованно в модели</h4>
<p>
Допустим, в популяции есть два варианта одного и того же гена:
</p>
<ul>
<li>вариант <b>A</b></li>
<li>вариант <b>B</b></li>
</ul>
<p>Перед запуском модели можно определить</p>
<ol>
<li>размер популяции</li>
<li>преимущество, которое обеспечиает вариант <b>A</b> по сравнению с вариантом <b>B</b></li>
<li>начальное распространение варианта <b>A</b> в популяции</li>
</ol>
<p>
В модели симулируется изменение частоты сразу четырёх пар аллелей. и на графике они показаны разным цветом
</p>

<p>
Для определения частот аллелей в модели используется следующий алгоритм:
</p>
<p>
<b>Например:</b> размер популяции = 1000, вариант <b>A</b> = 400, варианта <b>B</b> = 600
</p>

<p>
Теперь мы 1000 раз генерируем случайное число от 0 до 1000.
</p>
<ul>
<li>Если полученное число в диапозоне от 0 до 400, то получаем особь с вариантом <b>A</b> </li>
<li>Если полученное число в диапозоне от 400 до 1000, то получаем особь с вариантом <b>B</b> </li>
</ul>

<p>
Если вариантом <b>A</b> обеспечивает <b> 1 % </b> преимущество, то увеличиваем 400  на <b> 1 % </b> и получаем 404
</p>
<p>
Теперь мы 1000 раз генерируем случайное число от 0 до 1004. <i>(404 + 600)</i>
</p>
<ul>
<li>Если полученное число в диапозоне от 0 до 404, то получаем особь с вариантом <b>A</b> </li>
<li>Если полученное число в диапозоне от 404 до 1004, то получаем особь с вариантом <b>B</b> </li>
</ul>

<img src="img/drf.png" /> <br>




<hr>
<h2> полная модель </h2>
<hr>
<h3>model No. 3</h3>
<div>
<canvas id="cnv_s3" width="900" height="655"></canvas>  <br>    			
<button id="step_s3" >START</button> &nbsp; &nbsp; 
<input id="cross_s3" type="checkbox" > cross &nbsp; &nbsp; 
<select id="viewSelect_s3">
	<option value="0" selected> genom </option>
	<option value="1">          bar   </option>
	<option value="2">          graph </option>
</select>  <br> <br>
<input type="range" id="mut_s3" min="0" max="1" value="0.5" step = "0.05" />  
<label id = "mutP_s3">0.5</label> &nbsp; &nbsp; <b>probability of mutation</b> <br>
<input type="range" id="power_s3" min="0" max="3" value="2" step = "1" />  
<label id = "powerP_s3">2</label> &nbsp; &nbsp; <b>strength of selection</b> <br>
<button id="reset_s3" >RESET</button> &nbsp; &nbsp;  &nbsp; &nbsp;
<select id="pop_s3">
	<option selected> 600 </option>
	<option >        1800 </option>
	<option >        5400 </option>
</select>  &nbsp; &nbsp; <b>population size</b> <br><br>
<input id="stop9000_s3"  type="checkbox" > stop at 9000 

</div>
<hr>
<script  src="script/crossFull.js" > </script>  
 

<h3>описание модели</h3> 
<p> Это дальнейшее развитие первой модели, но здесь, что бы увидеть преимущество полового размножения, увеличен размер популяции <i>(600, 1800, 5400)</i> и размер генома <i>(224)</i>.
</p>
 
 <p> 
 Каждый ген может увеличивать приспособленность на единицу, уменьшать на единицу или ни как не влиять на приспособленность<br>
 Причём вероятность появления вредных мутаций в 90 раз выше.
 </p>
 
<ul> 
 <li>вредные мутации - 90 % </li>
 <li>нейтральные мутации - 9 % </li>
 <li>полезные мутации - 1 % </li>
 </ul>
 
  <img src="img/gn90.png" /> <br>
 

 
<p> 
  Можно менять способы отображения:
  	<ul>
  	<li><b>genom</b> - стандартный режим, где каждый ген изображён короткой полоской толщиной в 1 пиксель, полезные гены синим цветом, вредные оранжевым. </li>
  	<li><b>bar</b> - столбчатая диаграма, показывающая распространёность вредных и полезных мутаций в каждом отдельном гене в популяции. </li>
  	<li><b>graph</b> - строит график, где отображается величина приспособленности у самого лучшего организма в популяции.  <br>
  	Также рисуются графики среднего количество вредных и полезных мутаций у одной особи</li>
  	</ul>
</p> 

<h4> Половое размножение против бесполого </h4>
 <p> 
 С помощью чекбокса <b>cross</b> можно включать и отключать половое размножения.
 </p> 
 <p> 
 Экпериментируя с моделью, можно убедиться, что при <b>половом размножении</b> не просто возрастает скорость, с которой растёт приспособленность популяции, но и возрастает граница к которой приспособленность может достигнуть. 
</p> 
 <p>
 На третьем изображении <b>половое размножение</b> было отключено и приспособленность сразу стала опускаться.
  </p>

 <img src="img/main3.png" /> <br>
 
 
<h4> Влияние вероятности мутации на скорость эволюции </h4>
 <p>
 <b>probability of mutation</b> позволяет выбрать, с какой вероятностью у нового организма произойдёт мутация <br>
 <i>(случайное изменение одного из генов)</i> 
 </p>
 
  <p>
  Модель показывает, что при <b>половом размножении</b> это не сильно влияет на развитие популяции <br>
  Рекомбинация генетического материала позволяет быстро отсеивать вредные мутации и закреплять полезные<br>
  Причём, при увеличении вероятности мутаций, развитие может происходить быстрее.
  </p>

  <p>
  При <b>бесполом размножении</b> увеличение вероятности мутаций не позволяет подняться приспособленности выше определённого уровня.
  </p>
  
  <img src="img/mutprob.png" /> <br>

 <h4> Отключекие мутаций</h4>
 <p>В модели можно выставить вероятность мутации в ноль и мутаций происходить не будет.</p> 

 <p> 
 Без мутаций не будет появляться нового разнообразия и через короткое время геном всех организмов в популяции станет идентичным 
 </p>

  <p>
  При <b>половом размножении</b>, сохраниться значительная часть удачных вариантов, а большая часть вредных мутаций будет вытеснена из генома.
  </p>
  
  <p>
  При <b>бесполом размножении</b>, потомки одного из организмов быстро вытеснят всех остальных.<br>
   Если позапускать несколько раз, то можно получить небольшое состязание пары вариантов генома<br>
   Последний вариант генома во всей популяции будет полной копией одного из начальных организмов
  </p>

   <img src="img/mut.png" /> <br>
   
   <p>
   Этот эксперимент очень наглядно показывает преимущество <b>полового размножения</b> <br>
   А если взять популяцию не в 600 особей, а 5400, то при <b>половом размножении</b> появиться почти идеальный геном, в котором не хватает только десятка генов.<br>
   </p>
   <img src="img/mut0.png" /> <br>
   <p>
   При <b>бесполом размножении</b> в конце останется только один из изначальных вариантов генома при любом размере популяции.
   </p>
   

 <h4> Сила естественного отбора </h4>
 <p>
 <b> strength of selection </b> позволяет регулировать силу отбора <br>
 
 Чем выше параметр, тем меньше шансов для менее приспособленных оставить потомство.<br>
 На рисунке показано, как будет выглядить вероятность оставить потомство у особей, чья приспособленность равна <b>11</b>, <b>12</b> и <b>13</b>.
 </p>
  <img src="img/otbor2.png" /><br> 
 <p>
 При <b> strength of selection = 0</b> , отбора нет. <br>
 Особи для оставления потомства выбираются полностью случайно. 
 </p>
 <p>
 В самой первой модели я объяснял, как происходит отбор <br>
 Теперь формула выглядит так <br><br>
  <code> приспособленность  = приспособленость - (минимальная приспособленность - constant)</code> <br><br>
  Вместо единицы мы используем константу, которая зависит от значения <b> strength of selection </b> 
  <ol><li><b>100</b></li><li><b>10</b></li><li><b>1</b></li></ol>
 </p>
 
  <p>
  При значении <b> strength of selection = 1 </b> , разница в выборе представляет из себя доли процента, но развитие всё равно происходит.
  </p>
  
  <img src="img/power.png" /> <br> 
 
   <p>
   Если отключить отбор, <b> strength of selection = 0</b>, то геном популяции быстро вернётся в исходное состояние, когда каждый ген будет иметь случайное значение.
   </p>
 
 
<h4> Размер популяции</h4>
<p>
Одно из самых сильных влияний на развитие популяции оказывает численность популяции. <br>
</p>
<p>
Можно выбрать три варианта численности популяции <i>(600, 1800, 5400)</i><br>
<i>(В режиме <b>genom</b> видно только 600 геномов)</i>
</p>

<p>
Для графиков использовался самый слабый отбор <b> strength of selection = 1 </b><br>
При половом размножении вероятность мутации <b>0.5</b>, при бесполом <b>0.1</b>
</p>





 
  <img src="img/pop.png" />
 </body>    
</html>